import{j as e,r as m,q as A,S as I,a as k,f as z}from"./app-CM_53ag-.js";import{A as O}from"./AuthenticatedLayout-D4R4wwZx.js";import{I as o}from"./InputLabel-BEtyGDv8.js";import{T as f,I as c}from"./TextInput-B5UKG27d.js";import{X as U}from"./x-C1RpThLZ.js";import{S as L}from"./send-DNDtSbB_.js";import{z as P}from"./transition-CF6lRaLe.js";import{L as _}from"./dialog-D3HxsCPS.js";import{f as w}from"./format-zWY_uF1i.js";import{A as V}from"./AuthorizedPassengersInput-Cxb9SplB.js";import"./Dropdown-NYFviwhB.js";import"./portal-N1CzU3lS.js";import"./createLucideIcon-mPmu35-0.js";import"./plus-D_n6UFi2.js";import"./user-Bqgk2e5v.js";function G({isOpen:p,closeModal:x,formData:t,user:a,onConfirmSubmit:u,submitting:i,previewUrl:h}){if(!t)return null;const v=r=>{try{return w(new Date(r),"MMMM d, yyyy")}catch{return r}},g=r=>{try{return w(new Date(`2000-01-01 ${r}`),"h:mm a")}catch{return r}};return e.jsx(P,{appear:!0,show:p,as:m.Fragment,children:e.jsxs(_,{as:"div",className:"relative z-50",onClose:x,children:[e.jsx(P.Child,{as:m.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/25"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:e.jsxs(_.Panel,{className:"w-full max-w-4xl transform overflow-hidden rounded-lg bg-white shadow-xl transition-all",children:[e.jsxs(_.Title,{as:"div",className:"flex items-center justify-between border-b p-4 bg-gray-50",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Request Preview"}),e.jsx("button",{onClick:x,className:"text-gray-400 hover:text-gray-500",disabled:i,children:e.jsx(U,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"border rounded-lg p-6 bg-white shadow-sm mb-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"REQUEST FOR USE OF VEHICLE"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Please review your request before submitting"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-3 border-b pb-2",children:"REQUESTOR INFORMATION"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Name:"}),e.jsx("p",{className:"font-medium",children:a==null?void 0:a.name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Department:"}),e.jsx("p",{className:"font-medium",children:(a==null?void 0:a.department)||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Date Requested:"}),e.jsx("p",{className:"font-medium",children:w(new Date,"MMMM d, yyyy")})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-3 border-b pb-2",children:"TRAVEL SCHEDULE"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Date of Travel:"}),e.jsx("p",{className:"font-medium",children:v(t.date_of_travel)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Days of Travel:"}),e.jsxs("p",{className:"font-medium",children:[t.days_of_travel," day(s)"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Time of Travel:"}),e.jsx("p",{className:"font-medium",children:g(t.time_of_travel)})]})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-3 border-b pb-2",children:"REQUEST DETAILS"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Destination:"}),e.jsx("p",{className:"font-medium",children:t.destination})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Purpose:"}),e.jsx("p",{className:"font-medium",children:t.purpose})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Authorized Passengers:"}),e.jsx("p",{className:"font-medium",children:t.authorized_passengers})]})]})]}),e.jsx("div",{className:"text-xs text-gray-500 text-center pt-4 border-t",children:"This request will be sent to the Assignment Admin for review"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"PDF Preview (Use PDF controls to zoom or print):"}),e.jsx("div",{className:"border rounded-lg overflow-hidden",style:{height:"500px"},children:e.jsx("iframe",{src:h,className:"w-full h-full",title:"Request Form PDF Preview"})})]}),e.jsxs("div",{className:"flex justify-between items-center gap-3 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:x,className:"px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 border rounded-md",disabled:i,children:"Go Back to Edit"}),e.jsxs("button",{onClick:u,className:"flex items-center gap-2 px-6 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:opacity-50",disabled:i,children:[e.jsx(L,{className:"w-4 h-4"}),i?"Submitting...":"Confirm & Submit Request"]})]})]})]})})})]})})}function ie(){const{auth:p}=A().props,[x,t]=m.useState(!1),[a,u]=m.useState(""),[i,h]=m.useState(!1),[v,g]=m.useState([]),{data:r,setData:l,post:S,processing:j,errors:n,clearErrors:F}=I({destination:"",purpose:"",authorized_passengers:"",date_of_travel:"",days_of_travel:"",half_day_period:"",time_of_travel:""}),E=s=>{g(s),l("authorized_passengers",s.join(", "))},q=()=>{const s=parseFloat(r.days_of_travel);return!isNaN(s)&&s%1!==0},C=s=>{const y=s.target.value;l("days_of_travel",y);const b=parseFloat(y);!isNaN(b)&&b%1===0&&l("half_day_period","")},T=async s=>{if(s.preventDefault(),F(),["destination","purpose","date_of_travel","days_of_travel","time_of_travel"].filter(d=>!r[d]).length>0){alert("Please fill in all required fields before previewing.");return}if(q()&&!r.half_day_period){alert("Please select morning or afternoon for half-day requests.");return}h(!0);try{const d=new URLSearchParams;Object.keys(r).forEach(N=>{r[N]&&d.append(N,r[N])});const M=`/request/preview?${d.toString()}`;u(M),t(!0)}catch(d){console.error("Error generating preview:",d),alert("Failed to generate preview. Please try again.")}finally{h(!1)}},R=()=>{S("/request",{onSuccess:()=>{t(!1)},onError:s=>{t(!1),console.error("Submission errors:",s)}})},D=()=>{t(!1),u("")};return e.jsxs(O,{header:e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800",children:"Request Vehicle"}),children:[e.jsx(k,{title:"Request Vehicle"}),e.jsx("div",{className:"flex items-center justify-center min-h-[calc(100vh-80px)] bg-gray-100 px-4",children:e.jsxs("div",{className:"w-full max-w-3xl bg-white shadow rounded-xl p-6 overflow-y-auto max-h-[90vh]",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4 text-center text-gray-800",children:"Request for Use of Vehicle"}),e.jsxs("form",{onSubmit:T,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"destination",required:!0,children:"Destination"}),e.jsx(f,{id:"destination",value:r.destination,onChange:s=>l("destination",s.target.value),className:"mt-1 block w-full",required:!0}),e.jsx(c,{message:n.destination})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"purpose",required:!0,children:"Purpose"}),e.jsx("textarea",{id:"purpose",value:r.purpose,onChange:s=>l("purpose",s.target.value),className:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm",rows:"3",required:!0}),e.jsx(c,{message:n.purpose})]}),e.jsx(V,{passengers:v,onChange:E,error:n.authorized_passengers}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"date_of_travel",required:!0,children:"Date of Travel"}),e.jsx(f,{id:"date_of_travel",type:"date",value:r.date_of_travel,onChange:s=>l("date_of_travel",s.target.value),className:"mt-1 block w-full",min:new Date().toISOString().split("T")[0],required:!0}),e.jsx(c,{message:n.date_of_travel})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"days_of_travel",required:!0,children:"Days of travel"}),e.jsx(f,{id:"days_of_travel",type:"number",step:"0.5",value:r.days_of_travel,onChange:C,className:"mt-1 block w-full",min:"0.5",required:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter 0.5 for half-day, 1 for full day, 1.5 for day and half, etc."}),e.jsx(c,{message:n.days_of_travel})]}),q()&&e.jsxs("div",{children:[e.jsx(o,{htmlFor:"half_day_period",required:!0,children:"Half-Day Period"}),e.jsxs("select",{id:"half_day_period",value:r.half_day_period,onChange:s=>l("half_day_period",s.target.value),className:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm",required:!0,children:[e.jsx("option",{value:"",children:"Select Period"}),e.jsx("option",{value:"morning",children:"Morning (until 12 PM)"}),e.jsx("option",{value:"afternoon",children:"Afternoon (until 5 PM)"})]}),e.jsx(c,{message:n.half_day_period})]})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"time_of_travel",required:!0,children:"Time of Travel"}),e.jsx(f,{id:"time_of_travel",type:"time",value:r.time_of_travel,onChange:s=>l("time_of_travel",s.target.value),className:"mt-1 block w-full",required:!0}),e.jsx(c,{message:n.time_of_travel})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-4",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Note:"}),` After clicking "Preview Request", you'll be able to review your request form before final submission.`]})}),e.jsxs("div",{className:"flex justify-end gap-4 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>z.visit(route("dashboard")),className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",disabled:i||j,children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-6 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50",disabled:i||j,children:i?"Generating Preview...":"Preview Request"})]})]})]})}),e.jsx(G,{isOpen:x,closeModal:D,formData:r,user:p.user,onConfirmSubmit:R,submitting:j,previewUrl:a})]})}export{ie as default};
