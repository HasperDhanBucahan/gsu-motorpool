import{r as o,j as e,a as k,d as l,f as C}from"./app-CM_53ag-.js";import{A as _,B as m,T as u}from"./AuthenticatedLayout-D4R4wwZx.js";import{C as A}from"./check-B-tBOnZh.js";import"./Dropdown-NYFviwhB.js";import"./transition-CF6lRaLe.js";import"./portal-N1CzU3lS.js";import"./createLucideIcon-mPmu35-0.js";function B({auth:h}){const[n,p]=o.useState([]),[a,c]=o.useState("all"),[g,d]=o.useState(!0),s=async()=>{d(!0);try{const t=await l.get("/api/notifications");p(t.data.notifications)}catch(t){console.error("Failed to fetch notifications:",t)}finally{d(!1)}};o.useEffect(()=>{s()},[]);const x=n.filter(t=>a==="unread"?!t.read:a==="read"?t.read:!0),f=async t=>{try{await l.post(`/api/notifications/${t}/read`),s()}catch(i){console.error("Failed to mark as read:",i)}},b=async()=>{try{await l.post("/api/notifications/mark-all-read"),s()}catch(t){console.error("Failed to mark all as read:",t)}},N=async t=>{try{await l.delete(`/api/notifications/${t}`),s()}catch(i){console.error("Failed to delete notification:",i)}},j=async()=>{if(confirm("Are you sure you want to clear all read notifications?"))try{await l.post("/api/notifications/clear-read"),s()}catch(t){console.error("Failed to clear notifications:",t)}},y=t=>{t.read||f(t.id),t.action_url&&C.visit(t.action_url)},v=t=>new Date(t).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),w=t=>{switch(t){case"request_submitted":return"ðŸ“";case"request_assigned":return"ðŸš—";case"request_approved":return"âœ…";case"request_declined":return"âŒ";case"ticket_preparation":return"ðŸŽ«";case"ticket_generated":return"ðŸŽ«";case"trip_assigned":return"ðŸš—";default:return"ðŸ””"}},r=n.filter(t=>!t.read).length;return e.jsxs(_,{user:h.user,header:e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Notifications"}),children:[e.jsx(k,{title:"Notifications"}),e.jsx("div",{className:"py-6",children:e.jsxs("div",{className:"max-w-5xl mx-auto sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"bg-white shadow rounded-lg p-6 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(m,{className:"w-8 h-8 text-blue-600"}),e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-gray-600",children:[r," unread notification",r!==1?"s":""]})})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[r>0&&e.jsxs("button",{onClick:b,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition flex items-center gap-2",children:[e.jsx(A,{className:"w-4 h-4"}),"Mark all read"]}),e.jsxs("button",{onClick:j,className:"px-4 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600 transition flex items-center gap-2",children:[e.jsx(u,{className:"w-4 h-4"}),"Clear read"]})]})]}),e.jsxs("div",{className:"flex gap-2 border-b border-gray-200",children:[e.jsxs("button",{onClick:()=>c("all"),className:`px-4 py-2 font-medium transition ${a==="all"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:["All (",n.length,")"]}),e.jsxs("button",{onClick:()=>c("unread"),className:`px-4 py-2 font-medium transition ${a==="unread"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:["Unread (",r,")"]}),e.jsxs("button",{onClick:()=>c("read"),className:`px-4 py-2 font-medium transition ${a==="read"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:["Read (",n.length-r,")"]})]})]}),e.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:g?e.jsxs("div",{className:"p-8 text-center text-gray-500",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4",children:"Loading notifications..."})]}):x.length===0?e.jsxs("div",{className:"p-8 text-center text-gray-500",children:[e.jsx(m,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),e.jsxs("p",{className:"text-lg",children:["No ",a!=="all"?a:""," notifications"]})]}):e.jsx("div",{className:"divide-y divide-gray-200",children:x.map(t=>e.jsx("div",{onClick:()=>y(t),className:`p-6 cursor-pointer transition ${t.read?"hover:bg-gray-50":"bg-blue-50 hover:bg-blue-100"}`,children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"text-3xl flex-shrink-0",children:w(t.type)}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:`text-lg font-medium text-gray-900 ${t.read?"":"font-semibold"}`,children:t.title}),e.jsx("p",{className:"text-gray-700 mt-1 whitespace-pre-line",children:t.message}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:v(t.created_at)})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[!t.read&&e.jsx("div",{className:"w-3 h-3 bg-blue-600 rounded-full"}),e.jsx("button",{onClick:i=>{i.stopPropagation(),N(t.id)},className:"p-2 text-gray-400 hover:text-red-600 transition rounded hover:bg-red-50",children:e.jsx(u,{className:"w-5 h-5"})})]})]})})]})},t.id))})})]})})]})}export{B as default};
