import{r,j as e,f as T}from"./app-CM_53ag-.js";import{P as k,S as M}from"./save-BmrvCk2G.js";import{X as R}from"./x-C1RpThLZ.js";import{c as Y}from"./createLucideIcon-mPmu35-0.js";import{z as f}from"./transition-CF6lRaLe.js";import{L as u}from"./dialog-D3HxsCPS.js";/**
 * @license lucide-react v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],F=Y("rotate-ccw",X);function q({isOpen:l,closeModal:i,currentSignature:p}){const a=r.useRef(null),[b,h]=r.useState(!1),[m,x]=r.useState(!1),[c,d]=r.useState(!1);r.useEffect(()=>{if(l&&a.current){const t=a.current,s=t.getContext("2d"),n=t.getBoundingClientRect();t.width=n.width,t.height=n.height,s.fillStyle="white",s.fillRect(0,0,t.width,t.height),s.strokeStyle="#000000",s.lineWidth=2,s.lineCap="round",s.lineJoin="round"}},[l]);const g=t=>{const s=a.current,n=s.getBoundingClientRect(),o=s.width/n.width,D=s.height/n.height;return{x:(t.clientX-n.left)*o,y:(t.clientY-n.top)*D}},w=t=>{const n=a.current.getContext("2d"),o=g(t);n.beginPath(),n.moveTo(o.x,o.y),h(!0),x(!0)},y=t=>{if(!b)return;const n=a.current.getContext("2d"),o=g(t);n.lineTo(o.x,o.y),n.stroke()},v=()=>{h(!1)},j=t=>{t.preventDefault();const s=t.touches[0],n=new MouseEvent("mousedown",{clientX:s.clientX,clientY:s.clientY});a.current.dispatchEvent(n)},N=t=>{t.preventDefault();const s=t.touches[0],n=new MouseEvent("mousemove",{clientX:s.clientX,clientY:s.clientY});a.current.dispatchEvent(n)},S=t=>{t.preventDefault();const s=new MouseEvent("mouseup",{});a.current.dispatchEvent(s)},C=()=>{const t=a.current,s=t.getContext("2d");s.fillStyle="white",s.fillRect(0,0,t.width,t.height),x(!1)},E=()=>{if(!m){alert("Please draw your signature first");return}d(!0),a.current.toBlob(s=>{const n=new FormData;n.append("signature",s,"signature.png"),T.post(route("admin.signature.upload"),n,{onSuccess:()=>{d(!1),i()},onError:o=>{d(!1),alert(o.signature||"Failed to save signature")}})},"image/png")};return e.jsx(f,{appear:!0,show:l,as:r.Fragment,children:e.jsxs(u,{as:"div",className:"relative z-50",onClose:i,children:[e.jsx(f.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/25"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:e.jsxs(u.Panel,{className:"w-full max-w-3xl transform overflow-hidden rounded-lg bg-white shadow-xl transition-all",children:[e.jsxs(u.Title,{as:"div",className:"flex items-center justify-between border-b p-4 bg-gray-50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{className:"w-5 h-5 text-gray-600"}),e.jsx("h3",{className:"text-lg font-medium",children:"Create Your Signature"})]}),e.jsx("button",{onClick:i,className:"text-gray-400 hover:text-gray-500",disabled:c,children:e.jsx(R,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"p-6",children:[p&&e.jsx("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-md",children:e.jsx("p",{className:"text-sm text-blue-800",children:"You already have a signature. Drawing a new one will replace it."})}),e.jsx("div",{className:"mb-4",children:e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Draw your signature in the box below using your mouse or touchpad:"})}),e.jsx("div",{className:"border-2 border-gray-300 rounded-lg overflow-hidden mb-4 bg-white",children:e.jsx("canvas",{ref:a,onMouseDown:w,onMouseMove:y,onMouseUp:v,onMouseLeave:v,onTouchStart:j,onTouchMove:N,onTouchEnd:S,className:"cursor-crosshair w-full",style:{touchAction:"none",height:"200px",display:"block"}})}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("button",{type:"button",onClick:C,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",disabled:c,children:[e.jsx(F,{className:"w-4 h-4"}),"Clear"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:i,className:"px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 border rounded-md",disabled:c,children:"Cancel"}),e.jsxs("button",{onClick:E,className:"flex items-center gap-2 px-6 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:opacity-50",disabled:c||!m,children:[e.jsx(M,{className:"w-4 h-4"}),c?"Saving...":"Save Signature"]})]})]})]})]})})})]})})}export{q as S};
