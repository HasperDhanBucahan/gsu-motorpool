import{j as e,r as l,c as ae,a as Fe,f as ee}from"./app-CM_53ag-.js";import{A as Pe}from"./AuthenticatedLayout-D4R4wwZx.js";import{X as Q}from"./x-C1RpThLZ.js";import{M as le}from"./map-pin-CuCzhjHC.js";import{F as V}from"./file-text-BuT2rTD0.js";import{a as se,U as ie,C as te}from"./users-DYKfnPp_.js";import{z as B}from"./transition-CF6lRaLe.js";import{L as S}from"./dialog-D3HxsCPS.js";import{f as D}from"./format-zWY_uF1i.js";import{c as ne}from"./createLucideIcon-mPmu35-0.js";import{S as Ee}from"./send-DNDtSbB_.js";import{E as Re}from"./eye-CaPjzHpH.js";import{D as be}from"./download-BNlgXHtj.js";import{C as Ye}from"./circle-alert-x6lWoPzX.js";import{C as Le}from"./car-Cbx68Keb.js";import{C as fe}from"./circle-check-big-CyQMP5RP.js";import{P as $e}from"./plus-D_n6UFi2.js";import"./Dropdown-NYFviwhB.js";import"./portal-N1CzU3lS.js";/**
 * @license lucide-react v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Oe=ne("arrow-left",ze);/**
 * @license lucide-react v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]],Ie=ne("circle-user",Ve);/**
 * @license lucide-react v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],re=ne("loader-circle",Ue);function Xe({isOpen:w,closeModal:p,request:a,onSubmit:c,ticketNumber:d,setTicketNumber:t,processing:u}){var f,x;if(!a)return null;const r=m=>D(new Date(m),"MMMM d, yyyy"),g=m=>D(new Date(`2000-01-01 ${m}`),"h:mm a"),b=m=>{m.preventDefault();const h=d.trim();if(!h){alert("Please enter a ticket number");return}if(!/^\d{4}-\d{2}-(0[1-9]|[1-9]\d|[1-9]\d{2})$/.test(h)){alert(`Please enter a valid ticket number:
- Format: YYYY-MM-XX (01-99) or YYYY-MM-XXX (100-999)
- Examples: 2026-01-01, 2026-01-45, 2026-01-100`);return}c(a.id,h)};return e.jsx(B,{appear:!0,show:w,as:l.Fragment,children:e.jsxs(S,{as:"div",className:"relative z-50",onClose:()=>{},children:[e.jsx(B.Child,{as:l.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/25"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:e.jsxs(S.Panel,{className:"w-full max-w-2xl transform overflow-hidden rounded-lg bg-white shadow-xl transition-all",children:[e.jsxs(S.Title,{as:"div",className:"flex items-center justify-between border-b p-4",children:[e.jsxs("h3",{className:"text-lg font-medium",children:[a.trip_ticket_number?"Update":"Assign"," Trip Ticket Number"]}),e.jsx("button",{onClick:p,className:"text-gray-400 hover:text-gray-500",disabled:u,children:e.jsx(Q,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Requestor"}),e.jsx("p",{className:"mt-1",children:(f=a.user)==null?void 0:f.name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Department"}),e.jsx("p",{className:"mt-1",children:((x=a.user)==null?void 0:x.department)||"N/A"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(le,{className:"w-5 h-5 text-gray-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Destination"}),e.jsx("p",{className:"mt-1",children:a.destination})]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(V,{className:"w-5 h-5 text-gray-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Purpose"}),e.jsx("p",{className:"mt-1",children:a.purpose})]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(se,{className:"w-5 h-5 text-gray-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Travel Date"}),e.jsx("p",{className:"mt-1",children:r(a.date_of_travel)})]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ie,{className:"w-5 h-5 text-gray-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Passengers"}),e.jsx("p",{className:"mt-1",children:a.authorized_passengers??"N/A"})]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(te,{className:"w-5 h-5 text-gray-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Time"}),e.jsx("p",{className:"mt-1",children:g(a.time_of_travel)})]})]})]}),e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Trip Ticket Number"}),e.jsx("input",{type:"text",value:d,onChange:m=>t(m.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Enter trip ticket number",required:!0,disabled:u})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:p,className:"px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 border rounded-md disabled:opacity-50",disabled:u,children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",disabled:u,children:u?"Saving...":"Assign Ticket Number"})]})]})]})]})})})]})})}function He({isOpen:w,closeModal:p,request:a,onSend:c,sending:d,onBack:t}){var b,f,x,m,h;if(!a)return null;const u=F=>D(new Date(F),"MMMM d, yyyy"),r=F=>D(new Date(`2000-01-01 ${F}`),"h:mm a"),g=()=>{c&&c(a.id)};return e.jsx(B,{appear:!0,show:w,as:l.Fragment,children:e.jsxs(S,{as:"div",className:"relative z-50",onClose:()=>{},children:[e.jsx(B.Child,{as:l.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/25"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:e.jsxs(S.Panel,{className:"w-full max-w-4xl transform overflow-hidden rounded-lg bg-white shadow-xl transition-all",children:[e.jsxs(S.Title,{as:"div",className:"flex items-center justify-between border-b p-4 bg-gray-50",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Trip Ticket Preview"}),e.jsx("button",{onClick:p,className:"text-gray-400 hover:text-gray-500 hidden",disabled:d,children:e.jsx(Q,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"border rounded-lg p-6 bg-white shadow-sm mb-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"TRIP TICKET"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Ticket #: ",a.trip_ticket_number||"Not Assigned"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-3 border-b pb-2",children:"REQUEST DETAILS"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Requestor:"}),e.jsx("p",{className:"font-medium",children:(b=a.user)==null?void 0:b.name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Department:"}),e.jsx("p",{className:"font-medium",children:((f=a.user)==null?void 0:f.department)||"N/A"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-3 border-b pb-2",children:"ASSIGNMENT"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Driver:"}),e.jsx("p",{className:"font-medium",children:((x=a.driver)==null?void 0:x.name)||"Not assigned"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Vehicle:"}),e.jsxs("p",{className:"font-medium",children:[((m=a.vehicle)==null?void 0:m.description)||"N/A"," - ",((h=a.vehicle)==null?void 0:h.plate_number)||"N/A"]})]})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-3 border-b pb-2",children:"TRIP INFORMATION"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Destination:"}),e.jsx("p",{className:"font-medium",children:a.destination})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Purpose:"}),e.jsx("p",{className:"font-medium",children:a.purpose})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Travel Date:"}),e.jsx("p",{className:"font-medium",children:u(a.date_of_travel)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Travel Time:"}),e.jsx("p",{className:"font-medium",children:r(a.time_of_travel)})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Authorized Passengers:"}),e.jsx("p",{className:"font-medium",children:a.authorized_passengers})]})]}),e.jsxs("div",{className:"text-xs text-gray-500 text-center pt-4 border-t",children:["Generated on ",D(new Date,"MMMM d, yyyy h:mm a")]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"PDF Preview (Use PDF controls to download or print):"}),e.jsx("div",{className:"border rounded-lg overflow-hidden",style:{height:"500px"},children:e.jsx("iframe",{src:route("tickets.preview",a.id),className:"w-full h-full",title:"Trip Ticket PDF Preview"})})]}),e.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-yellow-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm text-yellow-700",children:'You must complete this action. Click "Back to Edit" to modify or "Send to Assignment Admin" to proceed.'})})]})}),e.jsxs("div",{className:"flex justify-between items-center gap-3 pt-4 border-t",children:[e.jsxs("button",{onClick:t,className:"flex items-center gap-2 px-6 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50",disabled:d,children:[e.jsx(Oe,{className:"w-4 h-4"}),"Back to Edit"]}),e.jsxs("button",{onClick:g,className:"flex items-center gap-2 px-6 py-2 text-sm font-medium text-white bg-green-600 rounded-md hover:bg-green-700 disabled:opacity-50",disabled:d,children:[e.jsx(Ee,{className:"w-4 h-4"}),d?"Sending...":"Send to Assignment Admin"]})]})]})]})})})]})})}const Be=({isOpen:w,closeModal:p,request:a})=>{var g,b,f,x;if(!a)return null;const c=m=>D(new Date(m),"MMMM d, yyyy"),d=m=>D(new Date(`2000-01-01 ${m}`),"h:mm a"),t=a.id&&a.id!=="preview"&&typeof a.id=="number",u=()=>{t&&window.open(route("tickets.preview",a.id),"_blank")},r=()=>{t&&(window.location.href=route("tickets.download",a.id))};return e.jsxs(S,{open:w,onClose:p,className:"relative z-50",children:[e.jsx("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),e.jsx("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:e.jsxs(S.Panel,{className:"mx-auto max-w-3xl w-full bg-white rounded-lg shadow-xl",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsxs("div",{children:[e.jsx(S.Title,{className:"text-xl font-semibold text-gray-900",children:"Trip Ticket Details"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"View trip ticket information"})]}),e.jsx("button",{onClick:p,className:"text-gray-400 hover:text-gray-500",children:e.jsx(Q,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6 space-y-6 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-blue-500 rounded-lg",children:e.jsx(V,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-blue-900",children:"Trip Ticket Number"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:["#",a.trip_ticket_number]})]})]}),a.ticket_sent_at&&e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-blue-600 font-medium",children:"Sent to Assignment Admin"}),e.jsx("p",{className:"text-xs text-blue-500",children:D(new Date(a.ticket_sent_at),"MMM d, yyyy h:mm a")})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Requestor"}),e.jsx("div",{className:"p-3 bg-gray-50 rounded-lg",children:e.jsx("p",{className:"text-sm text-gray-900",children:((g=a.user)==null?void 0:g.name)||"N/A"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Driver"}),e.jsx("div",{className:"p-3 bg-gray-50 rounded-lg",children:e.jsx("p",{className:"text-sm text-gray-900",children:((b=a.driver)==null?void 0:b.name)||"Not assigned"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Vehicle"}),e.jsx("div",{className:"p-3 bg-gray-50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-gray-900",children:[((f=a.vehicle)==null?void 0:f.model)||"N/A"," - ",((x=a.vehicle)==null?void 0:x.plate_number)||"N/A"]})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(se,{className:"w-4 h-4"}),"Travel Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[e.jsx(se,{className:"w-4 h-4"}),"Date of Travel"]}),e.jsx("div",{className:"p-3 bg-gray-50 rounded-lg",children:e.jsx("p",{className:"text-sm text-gray-900",children:c(a.date_of_travel)})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[e.jsx(te,{className:"w-4 h-4"}),"Time of Travel"]}),e.jsx("div",{className:"p-3 bg-gray-50 rounded-lg",children:e.jsx("p",{className:"text-sm text-gray-900",children:d(a.time_of_travel)})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[e.jsx(le,{className:"w-4 h-4"}),"Destination"]}),e.jsx("div",{className:"p-3 bg-gray-50 rounded-lg",children:e.jsx("p",{className:"text-sm text-gray-900",children:a.destination})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[e.jsx(ie,{className:"w-4 h-4"}),"Authorized Passengers"]}),e.jsx("div",{className:"p-3 bg-gray-50 rounded-lg",children:e.jsx("p",{className:"text-sm text-gray-900 whitespace-pre-wrap",children:a.authorized_passengers||"N/A"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Purpose"}),e.jsx("div",{className:"p-3 bg-gray-50 rounded-lg",children:e.jsx("p",{className:"text-sm text-gray-900 whitespace-pre-wrap",children:a.purpose})})]})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 p-6 border-t border-gray-200 bg-gray-50",children:[t?e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:u,className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:[e.jsx(Re,{className:"w-4 h-4"}),"Preview PDF"]}),e.jsxs("button",{onClick:r,className:"flex items-center gap-2 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors",children:[e.jsx(be,{className:"w-4 h-4"}),"Download PDF"]})]}):e.jsx("div",{className:"text-sm text-gray-500 italic",children:"PDF will be available after the ticket is saved"}),e.jsx("button",{onClick:p,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors",children:"Close"})]})]})})]})};function Je({isOpen:w,closeModal:p,onPreview:a,processing:c,initialData:d=null}){const[t,u]=l.useState({trip_ticket_number:"",driver_id:"",vehicle_id:"",authorized_passengers:"",destination:"",purpose:"",date_of_travel:"",time_of_travel:"",days_of_travel:"1",half_day_period:"full"}),[r,g]=l.useState({}),[b,f]=l.useState([]),[x,m]=l.useState([]),[h,F]=l.useState(!1),[C,k]=l.useState(null),[E,R]=l.useState(!1);l.useEffect(()=>{w&&(d?(u(d),R(!1)):u({trip_ticket_number:"",driver_id:"",vehicle_id:"",authorized_passengers:"",destination:"",purpose:"",date_of_travel:"",time_of_travel:"",days_of_travel:"1",half_day_period:"full"}),g({}),f([]),m([]),F(!1),k(null),d||R(!1))},[w,d]),l.useEffect(()=>{const i=setTimeout(()=>{I()},500);return()=>clearTimeout(i)},[t.date_of_travel,t.time_of_travel,t.days_of_travel,t.half_day_period]);const I=async()=>{const i=parseFloat(t.days_of_travel),A=!isNaN(i)&&i>0&&i%1!==0;if(!t.date_of_travel||!t.time_of_travel||!t.days_of_travel||isNaN(i)||i<.5){R(!1),f([]),m([]);return}if(A&&(!t.half_day_period||t.half_day_period==="full")){R(!1),f([]),m([]);return}F(!0),k(null);try{const M=new URLSearchParams({date_of_travel:t.date_of_travel,time_of_travel:t.time_of_travel,days_of_travel:t.days_of_travel,half_day_period:t.half_day_period||"full"}),Y=await fetch(`/ticket/check-availability?${M}`),z=await Y.json();if(!Y.ok)throw new Error(z.error||"Failed to check availability");const X=t.driver_id,W=t.vehicle_id;f(z.availableDrivers),m(z.availableVehicles),R(!0);const K=z.availableDrivers.some(y=>y.id.toString()===X),O=z.availableVehicles.some(y=>y.id.toString()===W);X&&!K&&(u(y=>({...y,driver_id:""})),g(y=>({...y,driver_id:"Previously selected driver is no longer available for this time period"}))),W&&!O&&(u(y=>({...y,vehicle_id:""})),g(y=>({...y,vehicle_id:"Previously selected vehicle is no longer available for this time period"})))}catch(M){console.error("Availability check error:",M),k(M.message),f([]),m([]),R(!1)}finally{F(!1)}},T=i=>{const{name:A,value:M}=i.target;u(Y=>({...Y,[A]:M})),r[A]&&g(Y=>({...Y,[A]:void 0}))},$=()=>{const i={};return t.trip_ticket_number.trim()?/^\d{4}-\d{2}-(0[1-9]|[1-9]\d|[1-9]\d{2})$/.test(t.trip_ticket_number)||(i.trip_ticket_number="Must be in YYYY-MM-XX (01-99) or YYYY-MM-XXX (100-999) format"):i.trip_ticket_number="Trip ticket number is required",t.driver_id||(i.driver_id="Driver is required"),t.vehicle_id||(i.vehicle_id="Vehicle is required"),t.destination.trim()||(i.destination="Destination is required"),t.purpose.trim()||(i.purpose="Purpose is required"),t.date_of_travel||(i.date_of_travel="Date of travel is required"),t.time_of_travel||(i.time_of_travel="Time of travel is required"),(!t.days_of_travel||parseFloat(t.days_of_travel)<.5)&&(i.days_of_travel="Days of travel must be at least 0.5"),parseFloat(t.days_of_travel)%1!==0&&!t.half_day_period&&(i.half_day_period="Please select morning or afternoon for half-day requests"),g(i),Object.keys(i).length===0},J=i=>{i.preventDefault(),$()&&a(t)},U=()=>{I()},G=!isNaN(parseFloat(t.days_of_travel))&&parseFloat(t.days_of_travel)>0&&parseFloat(t.days_of_travel)%1!==0,j=t.date_of_travel&&t.time_of_travel&&t.days_of_travel&&parseFloat(t.days_of_travel)>=.5&&(!G||t.half_day_period&&t.half_day_period!=="full");return e.jsx(B,{appear:!0,show:w,as:l.Fragment,children:e.jsxs(S,{as:"div",className:"relative z-50",onClose:()=>{},children:[e.jsx(B.Child,{as:l.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/25"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:e.jsxs(S.Panel,{className:"w-full max-w-3xl transform overflow-hidden rounded-lg bg-white shadow-xl transition-all",children:[e.jsxs(S.Title,{as:"div",className:"flex items-center justify-between border-b p-4 bg-gradient-to-r from-blue-600 to-blue-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Create New Trip Ticket"}),e.jsx("button",{onClick:p,className:"text-white hover:text-gray-200 transition-colors",disabled:c,children:e.jsx(Q,{className:"h-5 w-5"})})]}),e.jsxs("form",{onSubmit:J,className:"p-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[e.jsx(V,{className:"w-4 h-4 inline mr-1"}),"Trip Ticket Number *"]}),e.jsx("input",{type:"text",name:"trip_ticket_number",value:t.trip_ticket_number,onChange:T,className:`w-full rounded-md border ${r.trip_ticket_number?"border-red-300":"border-gray-300"} shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm px-3 py-2`,placeholder:"Enter trip ticket number (e.g., 2024-09-01)",disabled:c}),r.trip_ticket_number&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.trip_ticket_number})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[e.jsx(le,{className:"w-4 h-4 inline mr-1"}),"Destination *"]}),e.jsx("input",{type:"text",name:"destination",value:t.destination,onChange:T,className:`w-full rounded-md border ${r.destination?"border-red-300":"border-gray-300"} shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm px-3 py-2`,placeholder:"Enter destination",disabled:c}),r.destination&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.destination})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[e.jsx(V,{className:"w-4 h-4 inline mr-1"}),"Purpose *"]}),e.jsx("textarea",{name:"purpose",value:t.purpose,onChange:T,rows:3,className:`w-full rounded-md border ${r.purpose?"border-red-300":"border-gray-300"} shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm px-3 py-2`,placeholder:"Enter purpose of travel",disabled:c}),r.purpose&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.purpose})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[e.jsx(ie,{className:"w-4 h-4 inline mr-1"}),"Authorized Passengers"]}),e.jsx("textarea",{name:"authorized_passengers",value:t.authorized_passengers,onChange:T,rows:2,className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm px-3 py-2",placeholder:"Enter passenger names",disabled:c})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[e.jsx(se,{className:"w-4 h-4 inline mr-1"}),"Date of Travel *"]}),e.jsx("input",{type:"date",name:"date_of_travel",value:t.date_of_travel,onChange:T,className:`w-full rounded-md border ${r.date_of_travel?"border-red-300":"border-gray-300"} shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm px-3 py-2`,disabled:c}),r.date_of_travel&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.date_of_travel})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[e.jsx(te,{className:"w-4 h-4 inline mr-1"}),"Time of Travel *"]}),e.jsx("input",{type:"time",name:"time_of_travel",value:t.time_of_travel,onChange:T,className:`w-full rounded-md border ${r.time_of_travel?"border-red-300":"border-gray-300"} shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm px-3 py-2`,disabled:c}),r.time_of_travel&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.time_of_travel})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Days of Travel *"}),e.jsx("input",{type:"number",name:"days_of_travel",value:t.days_of_travel,onChange:T,step:"0.5",min:"0.5",className:`w-full rounded-md border ${r.days_of_travel?"border-red-300":"border-gray-300"} shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm px-3 py-2`,disabled:c}),r.days_of_travel&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.days_of_travel})]}),G&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Half Day Period *"}),e.jsxs("select",{name:"half_day_period",value:t.half_day_period,onChange:T,className:`w-full rounded-md border ${r.half_day_period?"border-red-300":"border-gray-300"} shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm px-3 py-2`,disabled:c,children:[e.jsx("option",{value:"",children:"Select Period"}),e.jsx("option",{value:"morning",children:"Morning (until 12:00 PM)"}),e.jsx("option",{value:"afternoon",children:"Afternoon (until 5:00 PM)"})]}),r.half_day_period&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.half_day_period})]})]}),C&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ye,{className:"w-5 h-5 text-red-600 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-red-800",children:C}),e.jsx("button",{type:"button",onClick:U,className:"mt-2 text-sm text-red-700 underline hover:text-red-800",children:"Retry"})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[e.jsx(Ie,{className:"w-4 h-4 inline mr-1"}),"Driver *"]}),e.jsx("select",{name:"driver_id",value:t.driver_id,onChange:T,className:`w-full rounded-md border ${r.driver_id?"border-red-300":"border-gray-300"} shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm px-3 py-2`,disabled:c||h||!j||C,children:h?e.jsx("option",{value:"",children:"Loading available drivers..."}):j?C?e.jsx("option",{value:"",children:"Error loading drivers"}):b.length===0?e.jsx("option",{value:"",children:"No drivers available for this period"}):e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"",children:"Select Driver"}),b.map(i=>e.jsx("option",{value:i.id,children:i.name},i.id))]}):e.jsx("option",{value:"",children:"Please select date and time first"})}),h&&e.jsxs("div",{className:"mt-1 flex items-center gap-2 text-sm text-gray-500",children:[e.jsx(re,{className:"w-4 h-4 animate-spin"}),e.jsx("span",{children:"Checking availability..."})]}),r.driver_id&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.driver_id})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[e.jsx(Le,{className:"w-4 h-4 inline mr-1"}),"Vehicle *"]}),e.jsx("select",{name:"vehicle_id",value:t.vehicle_id,onChange:T,className:`w-full rounded-md border ${r.vehicle_id?"border-red-300":"border-gray-300"} shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm px-3 py-2`,disabled:c||h||!j||C,children:h?e.jsx("option",{value:"",children:"Loading available vehicles..."}):j?C?e.jsx("option",{value:"",children:"Error loading vehicles"}):x.length===0?e.jsx("option",{value:"",children:"No vehicles available for this period"}):e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"",children:"Select Vehicle"}),x.map(i=>e.jsxs("option",{value:i.id,children:[i.description," - ",i.plate_number]},i.id))]}):e.jsx("option",{value:"",children:"Please select date and time first"})}),h&&e.jsxs("div",{className:"mt-1 flex items-center gap-2 text-sm text-gray-500",children:[e.jsx(re,{className:"w-4 h-4 animate-spin"}),e.jsx("span",{children:"Checking availability..."})]}),r.vehicle_id&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.vehicle_id})]})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end gap-3 border-t pt-4",children:[e.jsx("button",{type:"button",onClick:p,className:"px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 border border-gray-300 rounded-md disabled:opacity-50",disabled:c,children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-6 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",disabled:c||h,children:c?"Processing...":h?"Checking...":"Preview Ticket"})]})]})]})})})]})})}function hs({pendingRequests:w=[],allTickets:p=[],previewRequest:a=null,createdTripTicket:c=null}){const[d,t]=l.useState("pending"),[u,r]=l.useState(null),[g,b]=l.useState(!1),[f,x]=l.useState(!1),[m,h]=l.useState(!1),[F,C]=l.useState(!1),[k,E]=l.useState(null),[R,I]=l.useState(null),[T,$]=l.useState(""),[J,U]=l.useState(!1),[G,j]=l.useState(!1),[i,A]=l.useState(!1),[M,Y]=l.useState(""),[z,X]=l.useState(!1),[W,K]=l.useState(null),[O,y]=l.useState(new Date().getMonth()+1),[H,ge]=l.useState(new Date().getFullYear()),[P,ve]=l.useState(!1),[de,ce]=l.useState(!1),oe=ae.useMemo(()=>{const s=new Set;return p.forEach(o=>{const n=new Date(o.date_of_travel).getFullYear();s.add(n)}),Array.from(s).sort((o,n)=>n-o)},[p]);l.useEffect(()=>{a&&(E(a),x(!0))},[a]),l.useEffect(()=>{if(c){I(c),h(!0),t("all"),X(!0);const s=setTimeout(()=>{X(!1)},5e3);return()=>clearTimeout(s)}},[c]);const je=(s,o)=>{U(!0),ee.post(route("tickets.update-trip-ticket",s),{trip_ticket_number:o},{preserveScroll:!0,preserveState:!0,onSuccess:n=>{b(!1),U(!1);const N={...u,trip_ticket_number:o};E(N),x(!0)},onError:n=>{alert(n.trip_ticket_number||"Failed to update ticket number"),U(!1)},onFinish:()=>{U(!1)}})},ye=s=>{r(s),$(s.trip_ticket_number||""),b(!0)},Ne=()=>{k!=null&&k.is_new_ticket?(j(!0),fetch(route("tickets.create-trip-ticket.cancel"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').content},body:JSON.stringify({request_id:k.id})}).then(s=>s.json()).then(s=>{s.success?(x(!1),E(null),C(!0)):alert("Failed to cancel preview: "+(s.error||"Unknown error"))}).catch(s=>{console.error("Error:",s),alert("Failed to cancel preview")}).finally(()=>{j(!1)})):(x(!1),$(""),E(null),b(!0))},_e=s=>{I(s),h(!0)},we=s=>{j(!0),ee.post(route("tickets.send-to-assignment-admin",s),{},{onSuccess:()=>{j(!1),x(!1),E(null),r(null),$(""),t("all")},onError:o=>{j(!1),alert("Failed to send trip ticket: "+(o.message||"Unknown error"))}})},ke=s=>{A(!0),K(s),ee.post(route("tickets.create-trip-ticket.preview"),s,{preserveScroll:!0,onSuccess:()=>{A(!1),C(!1)},onError:o=>{A(!1);const n=Object.values(o).flat().join(`
`);alert(`Validation errors:
`+n)}})},Te=s=>{j(!0),ee.post(route("tickets.create-trip-ticket.confirm"),{request_id:s},{onSuccess:()=>{j(!1),x(!1),E(null),K(null)},onError:o=>{j(!1),alert("Failed to create trip ticket: "+(o.message||"Unknown error"))}})},Z=ae.useMemo(()=>p.filter(s=>{var o,n,N,v,_,q,he,pe;if(M){const L=M.toLowerCase();if(!(((o=s.trip_ticket_number)==null?void 0:o.toLowerCase().includes(L))||((N=(n=s.user)==null?void 0:n.name)==null?void 0:N.toLowerCase().includes(L))||((_=(v=s.driver)==null?void 0:v.name)==null?void 0:_.toLowerCase().includes(L))||((he=(q=s.vehicle)==null?void 0:q.plate_number)==null?void 0:he.toLowerCase().includes(L))||((pe=s.destination)==null?void 0:pe.toLowerCase().includes(L))))return!1}if(!P){const L=new Date(s.date_of_travel),ue=L.getMonth()+1,Ae=L.getFullYear();if(ue!==O||Ae!==H)return!1}return!0}),[p,M,O,H,P]),me=ae.useMemo(()=>[...Z].sort((s,o)=>!s.trip_ticket_number||!o.trip_ticket_number?0:s.trip_ticket_number.localeCompare(o.trip_ticket_number)),[Z]),Se=async()=>{ce(!0);try{const s=me.map(n=>{var N,v,_;return{trip_ticket_no:n.trip_ticket_number,driver:((N=n.driver)==null?void 0:N.name)||"N/A",vehicle:`${((v=n.vehicle)==null?void 0:v.plate_number)||"N/A"} - ${((_=n.vehicle)==null?void 0:_.description)||""}`,passengers:n.authorized_passengers||"",destination:n.destination,purpose:n.purpose,date_of_travel:D(new Date(n.date_of_travel),"MMMM d, yyyy"),remarks:""}}),o=await fetch("/ticket/export/excel",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').content},body:JSON.stringify({tickets:s,month:P?null:O,year:P?null:H,all_time:P})});if(o.ok){const n=await o.blob(),N=window.URL.createObjectURL(n),v=document.createElement("a");v.href=N;let _="trip_tickets_";if(P)_+="all_time";else{const q=new Date(H,O-1).toLocaleString("en-US",{month:"long"});_+=`${q}_${H}`}_+=".xlsx",v.download=_,document.body.appendChild(v),v.click(),window.URL.revokeObjectURL(N),document.body.removeChild(v)}else alert("Failed to export Excel")}catch(s){console.error("Excel export error:",s),alert("Failed to export Excel")}finally{ce(!1)}},Ce=s=>D(new Date(s),"MMMM d, yyyy"),Me=s=>D(new Date(`2000-01-01 ${s}`),"h:mm a"),De=[{value:1,label:"January"},{value:2,label:"February"},{value:3,label:"March"},{value:4,label:"April"},{value:5,label:"May"},{value:6,label:"June"},{value:7,label:"July"},{value:8,label:"August"},{value:9,label:"September"},{value:10,label:"October"},{value:11,label:"November"},{value:12,label:"December"}],xe=(s,o=!0)=>e.jsx("div",{className:"bg-white rounded-lg shadow overflow-x-auto",children:e.jsxs("table",{className:"min-w-full w-full table-auto",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50 text-left",children:[d==="all"&&e.jsx("th",{className:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Trip Ticket #"}),e.jsx("th",{className:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Requestor"}),e.jsx("th",{className:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Driver"}),e.jsx("th",{className:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Vehicle"}),e.jsx("th",{className:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Destination"}),e.jsx("th",{className:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Travel Date & Time"}),d==="pending"&&e.jsx("th",{className:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Purpose"}),o&&e.jsx("th",{className:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:s.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-6 py-8 text-center text-gray-500",children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx(V,{className:"w-12 h-12 mb-2 text-gray-400"}),e.jsx("p",{children:"No requests found"})]})})}):s.map(n=>{var N,v,_;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[d==="all"&&e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-blue-600",children:n.trip_ticket_number}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:((N=n.user)==null?void 0:N.name)||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:((v=n.driver)==null?void 0:v.name)||"Not assigned"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:((_=n.vehicle)==null?void 0:_.plate_number)||"Not assigned"}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900 max-w-xs truncate",children:n.destination}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[e.jsx("div",{children:Ce(n.date_of_travel)}),e.jsx("div",{className:"text-xs text-gray-500",children:Me(n.time_of_travel)})]}),d==="pending"&&e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900 max-w-xs truncate",children:n.purpose}),o&&e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:d==="pending"?e.jsxs("button",{onClick:()=>ye(n),className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded text-sm disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",disabled:J,children:[e.jsx(V,{className:"w-4 h-4"}),"Assign Ticket"]}):e.jsxs("button",{onClick:()=>_e(n),className:"bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded text-sm disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",disabled:J,children:[e.jsx(V,{className:"w-4 h-4"}),"View Ticket"]})})]},n.id)})})]})});return e.jsxs(Pe,{header:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("div",{children:e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Trip Ticket Management"})}),e.jsxs("button",{onClick:()=>C(!0),className:"inline-flex items-center px-4 py-2 bg-green-600 hover:bg-green-700 text-white text-sm font-medium rounded-md shadow-sm transition-colors",children:[e.jsx($e,{className:"w-4 h-4 mr-2"}),"Create Trip Ticket"]})]}),children:[e.jsx(Fe,{title:"Trip Ticket Management"}),z&&e.jsx("div",{className:"mb-4 bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(fe,{className:"w-5 h-5 text-green-600"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-green-900",children:"Trip ticket created successfully!"}),e.jsx("p",{className:"text-sm text-green-700",children:"The ticket has been sent to the Assignment Admin."})]}),e.jsx("button",{onClick:()=>X(!1),className:"text-green-600 hover:text-green-800",children:e.jsx(Q,{className:"w-4 h-4"})})]})}),e.jsxs("div",{className:"py-0 max-w-full",children:[e.jsx("div",{className:"mb-0",children:e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"-mb-px flex gap-4 px-6",children:[e.jsx("button",{onClick:()=>t("pending"),className:`
                                    py-4 px-6 text-sm font-medium border-b-2 transition-colors
                                    ${d==="pending"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}
                                `,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(te,{className:"w-4 h-4"}),e.jsx("span",{children:"Awaiting Ticket Number Assignment"}),e.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-0.5 rounded-full text-xs font-semibold",children:w.length})]})}),e.jsx("button",{onClick:()=>t("all"),className:`
                                    py-4 px-6 text-sm font-medium border-b-2 transition-colors
                                    ${d==="all"?"border-green-500 text-green-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}
                                `,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"w-4 h-4"}),e.jsx("span",{children:"List of All Tickets"}),e.jsx("span",{className:"bg-green-100 text-green-800 px-2 py-0.5 rounded-full text-xs font-semibold",children:p.length})]})})]})})}),d==="all"&&e.jsx("div",{className:"bg-gray-50 border-b border-gray-200 px-6 py-4",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{htmlFor:"search",className:"sr-only",children:"Search tickets"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("svg",{className:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),e.jsx("input",{type:"text",id:"search",value:M,onChange:s=>Y(s.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Search by ticket #, requestor, driver, vehicle, or destination..."})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Filter:"}),e.jsx("select",{value:O,onChange:s=>y(parseInt(s.target.value)),disabled:P,className:"rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm disabled:bg-gray-100 disabled:cursor-not-allowed",children:De.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))}),e.jsx("select",{value:H,onChange:s=>ge(parseInt(s.target.value)),disabled:P,className:"rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm disabled:bg-gray-100 disabled:cursor-not-allowed",children:oe.length>0?oe.map(s=>e.jsx("option",{value:s,children:s},s)):e.jsx("option",{value:new Date().getFullYear(),children:new Date().getFullYear()})}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:P,onChange:s=>ve(s.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"All Time"})]}),e.jsxs("div",{className:"text-sm text-gray-600 ml-2",children:["Showing ",e.jsx("span",{className:"font-semibold",children:Z.length})," of ",e.jsx("span",{className:"font-semibold",children:p.length})," tickets"]})]}),e.jsx("button",{onClick:Se,disabled:de||Z.length===0,className:"inline-flex items-center px-4 py-2 bg-green-600 hover:bg-green-700 text-white text-sm font-medium rounded-md shadow-sm transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:de?e.jsxs(e.Fragment,{children:[e.jsx(re,{className:"w-4 h-4 mr-2 animate-spin"}),"Exporting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(be,{className:"w-4 h-4 mr-2"}),"Export to Excel"]})})]})]})}),e.jsxs("div",{className:"mt-0",children:[d==="pending"&&xe(w),d==="all"&&xe(me)]})]}),e.jsx(Xe,{isOpen:g,closeModal:()=>{b(!1),r(null),$("")},request:u,onSubmit:je,ticketNumber:T,setTicketNumber:$,processing:J}),e.jsx(He,{isOpen:f,closeModal:()=>{x(!1),E(null)},request:k,onSend:k!=null&&k.is_new_ticket?Te:we,sending:G,onBack:Ne}),e.jsx(Be,{isOpen:m,closeModal:()=>{h(!1),I(null)},request:R}),e.jsx(Je,{isOpen:F,closeModal:()=>{C(!1),K(null)},onPreview:ke,processing:i,initialData:W})]})}export{hs as default};
